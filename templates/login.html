{% extends "base.html" %}
{% block title %}Log In â€“ AgroMate{% endblock %}

{% block content %}
<section class="auth-section">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-lg-5 col-md-7">

        <!-- Header -->
        <div class="text-center mb-4" data-aos="fade-down">
          <a href="{{ url_for('index') }}" class="d-inline-flex align-items-center gap-2 text-decoration-none mb-3">
            <div class="brand-icon"><i class="bi bi-flower2"></i></div>
            <span class="brand-text">Agro<span class="brand-accent">Mate</span></span>
          </a>
          <h2 class="fw-bold">Welcome Back</h2>
          <p class="text-muted">Log in to access your farming tools</p>
        </div>

        <!-- Flash messages -->
        {% with messages = get_flashed_messages(with_categories=true) %}
          {% for cat, msg in messages %}
          <div class="alert alert-{{ cat }} alert-dismissible fade show" role="alert">
            <i class="bi bi-{{ 'check-circle' if cat == 'success' else ('info-circle' if cat == 'info' else 'exclamation-triangle') }}-fill me-2"></i>{{ msg }}
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
          </div>
          {% endfor %}
        {% endwith %}

        <div class="auth-card" data-aos="fade-up">
          <form method="POST" action="{{ url_for('login') }}">

            <div class="mb-3">
              <label class="form-label fw-semibold">Email Address</label>
              <div class="input-group">
                <span class="input-group-text"><i class="bi bi-envelope"></i></span>
                <input type="email" name="email" class="form-control"
                       placeholder="you@example.com" required autofocus />
              </div>
            </div>

            <div class="mb-3">
              <label class="form-label fw-semibold">Password</label>
              <div class="input-group">
                <span class="input-group-text"><i class="bi bi-lock"></i></span>
                <input type="password" name="password" id="loginPassword" class="form-control"
                       placeholder="Your password" required />
                <button class="btn btn-outline-secondary" type="button" id="toggleLoginPwd">
                  <i class="bi bi-eye"></i>
                </button>
              </div>
            </div>

            <div class="d-flex justify-content-between align-items-center mb-4">
              <div class="form-check">
                <input type="checkbox" name="remember" class="form-check-input" id="rememberMe" />
                <label class="form-check-label text-muted small" for="rememberMe">Remember me</label>
              </div>
            </div>

            <button type="submit" class="btn btn-green w-100 py-3 fs-5 fw-semibold">
              <i class="bi bi-box-arrow-in-right me-2"></i>Log In
            </button>

            <div class="auth-divider my-4">
              <span>New to AgroMate?</span>
            </div>

            <a href="{{ url_for('signup') }}" class="btn btn-outline-success w-100 py-2 fw-semibold">
              <i class="bi bi-person-plus me-2"></i>Create a Free Account
            </a>
          </form>
        </div>

        <!-- Features reminder -->
        <div class="row g-2 mt-4" data-aos="fade-up" data-aos-delay="200">
          <div class="col-6">
            <div class="login-feature-chip">
              <i class="bi bi-seedling text-green"></i>
              <span>Crop Prediction</span>
            </div>
          </div>
          <div class="col-6">
            <div class="login-feature-chip">
              <i class="bi bi-droplet-fill text-primary"></i>
              <span>Fertilizer Advisor</span>
            </div>
          </div>
          <div class="col-6">
            <div class="login-feature-chip">
              <i class="bi bi-bug-fill text-danger"></i>
              <span>Disease Detection</span>
            </div>
          </div>
          <div class="col-6">
            <div class="login-feature-chip">
              <i class="bi bi-cloud-sun-fill text-warning"></i>
              <span>Weather Insights</span>
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>
</section>
{% endblock %}

{% block extra_scripts %}
<script>
  document.getElementById('toggleLoginPwd').addEventListener('click', function () {
    const input = document.getElementById('loginPassword');
    const icon  = this.querySelector('i');
    if (input.type === 'password') {
      input.type = 'text';
      icon.className = 'bi bi-eye-slash';
    } else {
      input.type = 'password';
      icon.className = 'bi bi-eye';
    }
  });
</script>
{% endblock %}
